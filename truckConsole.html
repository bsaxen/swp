<!--
-->
<style>
.slidecontainer {
  width: 100%;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  height: 25px;
  background: #d3d3d3;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
}

.slider:hover {
  opacity: 1;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 25px;
  height: 25px;
  background: #4CAF50;
  cursor: pointer;
}

.slider::-moz-range-thumb {
  width: 25px;
  height: 25px;
  background: #4CAF50;
  cursor: pointer;
}

</style>

<html>
<head>
<meta charset="ISO-8859-1"/>
<!--meta charset="UTF-8"/-->
<title>WebSocket console</title>
<script>
var socket = null;

var addressBox = null;
var logBox = null;
var messageBox = null;
var codeBox = null;
var reasonBox = null;

function addToLog(log) {
  logBox.value += log + '\n'
  // Large enough to keep showing the latest message.
  logBox.scrollTop = 1000000;
}

function send() {
  if (!socket) {
    addToLog('Not connected');
    return;
  }

  socket.send(messageBox.value);
  addToLog('> ' + messageBox.value);
  //messageBox.value = '';
  
  /*data = messageBox.value.map(function (num) {
    return String.fromCharCode(num);
  }).join('');
  addToLog('> ' + data);*/
  //var data = messageBox.value.charCodeAt(38);
  //addToLog('> ' + data);
}

function connect() {
  if ('WebSocket' in window) {
    socket = new WebSocket(addressBox.value);
  } else if ('MozWebSocket' in window) {
    socket = new MozWebSocket(addressBox.value);
  } else {
    return;
  }
  socket.binaryType = "arraybuffer";
  socket.onopen = function () {
    addToLog('Opened');
  };
  socket.onmessage = function (event) {
    addToLog('< ' + event.data);
  };
  socket.onerror = function () {
    addToLog('Error');
  };
  socket.onclose = function (event) {
    var logMessage = 'Closed (';
    if ((arguments.length == 1) && ('CloseEvent' in window) &&
        (event instanceof CloseEvent)) {
      logMessage += 'wasClean = ' + event.wasClean;
      // code and reason are present only for
      // draft-ietf-hybi-thewebsocketprotocol-06 and later
      if ('code' in event) {
        logMessage += ', code = ' + event.code;
      }
      if ('reason' in event) {
        logMessage += ', reason = ' + event.reason;
      }
    } else {
      logMessage += 'CloseEvent is not available';
    }
    addToLog(logMessage + ')');
  };

  addToLog('Connect ' + addressBox.value);
}

function closeSocket() {
  if (!socket) {
    addToLog('Not connected');
    return;
  }

  if (codeBox.value || reasonBox.value) {
    socket.close(codeBox.value, reasonBox.value);
  } else {
    socket.close();
  }
}

function printState() {
  if (!socket) {
    addToLog('Not connected');
    return;
  }

  addToLog(
      'url = ' + socket.url +
      ', readyState = ' + socket.readyState +
      ', bufferedAmount = ' + socket.bufferedAmount);
}

function init() {
  var scheme = window.location.protocol == 'https:' ? 'wss://' : 'ws://';
  var defaultAddress = scheme + window.location.host + '/wsinput';

  addressBox = document.getElementById('address');
  logBox = document.getElementById('log');
  messageBox = document.getElementById('message');
  codeBox = document.getElementById('code');
  reasonBox = document.getElementById('reason');

  addressBox.value = defaultAddress;

  if ('MozWebSocket' in window) {
    addToLog('Use MozWebSocket');
  } else if (!('WebSocket' in window)) {
    addToLog('WebSocket is not available');
  }
}

function sendPhoto() {

	size = 500
	var ba = new Uint8Array(size);
	for (var i = 0; i < size; i++) {
		ba[i] = i;
	}
	m = ba.buffer;
	socket.send(m);    
}

</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<h1>Scania Truck Simulator</h1>
<img src="truck2.jpg" alt="Scania truck" width="200" >

<body bgcolor=#f7f7f7  onload="init()">

<form action="#" onsubmit="connect(); return false;">
<input type="text" id="address" size="40">
<input type="submit" value="connect">
</form>


<form action="#" onsubmit="send(); return false;">

        <div class="slidecontainer">
                <input type="range" min="0" max="100" value="0" class="slider" id="myRange">
                <p>Speed km/h: <span id="demo"></span></p>
        </div> 
    <input type="radio" name="hb_status" value="on"> On
    <input type="radio" name="hb_status" value="off"> Off
<input type="submit" value="Handbrake">

</form>
<script>
        var slider = document.getElementById("myRange");
        var output = document.getElementById("demo");
        output.innerHTML = slider.value;
        
        slider.oninput = function() {
          output.innerHTML = this.value;
        }
</script>

<textarea id="log" rows="10" cols="80" readonly></textarea>
<form action="#" onsubmit="closeSocket(); return false;">
        Code <input type="text" id="code" size="10">
        Reason <input type="text" id="reason" size="20">
        <input type="submit" value="close">
        </form>
<br>

</body>
</html>
